<!DOCTYPE html>

<html lang="zh-CN">
  <head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Multi-lingual Support &mdash; Phalcon 0.5.0 文档</title>
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/configurationblock.css" type="text/css" />
    <!--
    <link rel="stylesheet" href="../static/default.css" type="text/css" />
    <link rel="stylesheet" href="../static/layout.css" type="text/css" />
    -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Rosario" type="text/css">
    <!-- link rel="stylesheet" href="http://phalconphp.com/css/s.css" type="text/css" -->
    <link rel="stylesheet" href="../static/s.css" type="text/css">
    <link rel="stylesheet" href="../static/docs.css" type="text/css">
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/docs.js"></script>
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="top" title="Phalcon 0.5.0 文档" href="../index.html" />
    <link rel="next" title="Universal Class Loader" href="loader.html" />
    <link rel="prev" title="Access Control Lists ACL" href="acl.html" /> 
  </head>
  <body>
    <div id="wrapper">
      <div id="header">
        <h1><a href="http://phalconphp.org/index" ><img border="0" src="../static/img/logo-small.png"></a></h1>
        <div align="center">
          <div id="nav-main" role="navigation">
            <div class="menubar">
              <div class="nav-main-features nav-first"><a href="http://bullsoft.org/phalcon-docs/">首页</a></div>
              <div class="nav-main-features nav-first"><a href="http://phalconphp.com/download" target="_blank">下载</a></div>
              <div class="nav-main-features"><a href="http://forum.phalconphp.com/">讨论</a></div>
              <div class="nav-main-features"><a target="blog" href="http://blog.phalconphp.com/">博客</a></div>
              <div class="nav-main-features nav-first"><a href="https://github.com/phalcon/cphalcon">GitHub</a></div>	      
            </div>
          </div>
        </div>
      </div>
    <div class="related">
      <ul>
        <li class="right" >
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="loader.html" title="Universal Class Loader"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="acl.html" title="Access Control Lists ACL"
             accesskey="P">上一页</a> |</li>
        <li><a href="http://phalconphp.org/index">首页</a> &raquo;</li>
        <li><a href="../index.html">Phalcon 0.5.0 文档</a> &raquo;</li> 
      </ul>
    </div>  

      <table width="90%" align="center">
        <tr>
      <td class="primary-box" width="25%" valign="top">
            
            <div id="searchbox" style="">
              <h3>搜索</h3>
                <form class="search" action="http://readthedocs.org/search/project/" method="get">
                  <input type="text" name="q" size="18">
                  <input type="submit" value="Go">
                  <input type="hidden" name="selected_facets" value="project:">
                </form>
            </div>
            <h3><a href="../index.html">內容目录</a></h3>
            <ul>
<li><a class="reference internal" href="#">Multi-lingual Support</a><ul>
<li><a class="reference internal" href="#adapters">Adapters</a></li>
<li><a class="reference internal" href="#component-usage">Component Usage</a></li>
</ul>
</li>
</ul>

            <h4>上一个主题</h4>
            <p class="topless"><a href="acl.html"
                                  title="上一章">Access Control Lists ACL</a></p>
            <h4>下一个主题</h4>
            <p class="topless"><a href="loader.html"
                                  title="下一章">Universal Class Loader</a></p>
            <h3>本页</h3>
            <ul class="this-page-menu">
              <li><a href="../sources/reference/translate.txt"
                     rel="nofollow">显示源代码</a></li>
            </ul>
        </td>
          <td class="second-box" valign="top">
            <div class="document">
                <div class="documentwrapper">
                  <div class="bodywrapper">
                <div class="body" >
                      
  <div class="section" id="multi-lingual-support">
<h1>Multi-lingual Support<a class="headerlink" href="#multi-lingual-support" title="永久链接至标题">¶</a></h1>
<p>The component <a class="reference internal" href="../api/Phalcon_Translate.html"><em>Phalcon\Translate</em></a> aids in creating multilingual applications. Applications using this component, display content in different languages, based on the user&#8217;s chosen language supported by the application.</p>
<div class="section" id="adapters">
<h2>Adapters<a class="headerlink" href="#adapters" title="永久链接至标题">¶</a></h2>
<p>This component makes use of adapters to read translation messages from different sources in a unified way.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Adapter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>NativeArray</td>
<td>Uses PHP arrays to store the messages. This is the best option in terms of performance.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="component-usage">
<h2>Component Usage<a class="headerlink" href="#component-usage" title="永久链接至标题">¶</a></h2>
<p>Translation strings are stored in files. The structure of these files could vary depending of the adapter used. Phalcon gives you the freedom to organize your translation strings. A simple structure could be:</p>
<div class="highlight-bash"><div class="highlight"><pre>app/messages/en.php
app/messages/es.php
app/messages/fr.php
app/messages/zh.php
</pre></div>
</div>
<p>Each file contains an array of the translations in a key/value manner. For each translation file, keys are unique. The same array is used in different files, where keys remain the same and values contain the translated strings depending on each language.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//app/messages/es.php</span>
<span class="nv">$messages</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;hi&quot;</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bye&quot;</span>     <span class="o">=&gt;</span> <span class="s2">&quot;Good Bye&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hi-name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hello %name%&quot;</span><span class="p">,</span>
    <span class="s2">&quot;song&quot;</span>    <span class="o">=&gt;</span> <span class="s2">&quot;This song is %song%&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//app/messages/fr.php</span>
<span class="nv">$messages</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">&quot;hi&quot;</span>      <span class="o">=&gt;</span> <span class="s2">&quot;Bonjour&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bye&quot;</span>     <span class="o">=&gt;</span> <span class="s2">&quot;Au revoir&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hi-name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Bonjour %name%&quot;</span><span class="p">,</span>
    <span class="s2">&quot;song&quot;</span>    <span class="o">=&gt;</span> <span class="s2">&quot;La chanson est %song%&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Implementing the translation mechanism in your application is trivial but depends on how you wish to implement it. You can use an automatic detection of the language from the user&#8217;s browser or you can provide a settings page where the user can select their language.</p>
<p>A simple way of detecting the user&#8217;s language is to parse the $_SERVER[&#8216;HTTP_ACCEPT_LANGUAGE&#8217;] contents, or if you wish, access it directly by calling $this-&gt;request-&gt;getBestLanguage() from an action/controller:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">class</span> <span class="nc">UserController</span> <span class="k">extends</span> <span class="nx">\Phalcon\Mvc\Controller</span>
<span class="p">{</span>

  <span class="k">protected</span> <span class="k">function</span> <span class="nf">_getTranslation</span><span class="p">()</span>
  <span class="p">{</span>

    <span class="c1">//Ask browser what is the best language</span>
    <span class="nv">$language</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">getBestLanguage</span><span class="p">();</span>

    <span class="c1">//Check if we have a translation file for that lang</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="s2">&quot;app/messages/&quot;</span><span class="o">.</span><span class="nv">$language</span><span class="o">.</span><span class="s2">&quot;.php&quot;</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">require</span> <span class="s2">&quot;app/messages/&quot;</span><span class="o">.</span><span class="nv">$language</span><span class="o">.</span><span class="s2">&quot;.php&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="c1">// fallback to some default</span>
       <span class="k">require</span> <span class="s2">&quot;app/messages/en.php&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//Return a translation object</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">\Phalcon\Translate\Adapter\NativeArray</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
       <span class="s2">&quot;content&quot;</span> <span class="o">=&gt;</span> <span class="nv">$messages</span>
    <span class="p">));</span>

  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">view</span><span class="o">-&gt;</span><span class="na">setVar</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Mike&quot;</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">view</span><span class="o">-&gt;</span><span class="na">setVar</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getTranslation</span><span class="p">());</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>The _getTranslation method is available for all actions that require translations. The $t variable is passed to the views, and with it, we can translate strings in that layer:</p>
<div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- welcome --&gt;</span>
<span class="c">&lt;!-- String: hi =&gt; &#39;Hello&#39; --&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$t</span><span class="o">-&gt;</span><span class="na">_</span><span class="p">(</span><span class="s2">&quot;hi&quot;</span><span class="p">),</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>The &#8220;_&#8221; function is returning the translated string based on the index passed. Some strings need to incorporate placeholders for calculated data i.e. Hello %name%. These placeholders can be replaced with passed parameters in the &#8220;_ function. The passed parameters are in the form of a key/value array, where the key matches the placeholder name and the value is the actual data to be replaced:</p>
<div class="highlight-html+php"><div class="highlight"><pre><span class="c">&lt;!-- welcome --&gt;</span>
<span class="c">&lt;!-- String: hi-user =&gt; &#39;Hello %name%&#39; --&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$t</span><span class="o">-&gt;</span><span class="na">_</span><span class="p">(</span><span class="s2">&quot;hi-user&quot;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s2">&quot;name&quot;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p>Some applications implement multilingual on the URL such as <a class="reference external" href="http://www.mozilla.org/">http://www.mozilla.org/</a><strong>es-ES</strong>/firefox/. Phalcon can implement this by using a <a class="reference internal" href="routing.html"><em>Router</em></a>.</p>
</div>
</div>


                    </div>
                  </div>
                </div>
            </div>
          </td>
        </tr>
      </table>
    <div class="related">
      <ul>
        <li class="right" >
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="loader.html" title="Universal Class Loader"
             >下一页</a> |</li>
        <li class="right" >
          <a href="acl.html" title="Access Control Lists ACL"
             >上一页</a> |</li> 
      </ul>
    </div>
        <div id="disqus_thread" style="margin:30px auto 0 auto; width:80%;"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'phalcon'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <div id="footer">
             &copy; 版权所有 2012, Phalcon Team.
             最后更新日期是 Jul 09, 2013.
            使用 <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.
        </div>

    </div>
  </body>
</html>